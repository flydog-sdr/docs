(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{373:function(s,e,a){"use strict";a.r(e);var t=a(18),r=Object(t.a)({},(function(){var s=this,e=s.$createElement,a=s._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"手动部署-flydog-sdr"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#手动部署-flydog-sdr"}},[s._v("#")]),s._v(" 手动部署 FlyDog SDR")]),s._v(" "),a("p",[s._v("某些 Raspberry Pi 上可能已运行有其他重要业务，故重新为 Raspberry Pi 刷写 FlyDog SDR Project 所提供的基础镜像，并再次配置其他业务已不现实。所以 FlyDog SDR Project 提供在现有系统上部署 FlyDog SDR 的方案。")]),s._v(" "),a("p",[s._v("经过测试，已知该方案可运行于以下针对树莓派的 Linux 发行版。")]),s._v(" "),a("ul",[a("li",[s._v("CentOS")]),s._v(" "),a("li",[s._v("Raspbian")]),s._v(" "),a("li",[s._v("Raspberry Pi OS")]),s._v(" "),a("li",[s._v("Ubuntu")])]),s._v(" "),a("h2",{attrs:{id:"启用-i2c-和-spi"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启用-i2c-和-spi"}},[s._v("#")]),s._v(" 启用 I2C 和 SPI")]),s._v(" "),a("p",[s._v("在 "),a("code",[s._v("/boot/config.txt")]),s._v(" 中启用 I2C 和 SPI。")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('[fdsdr@centos ~]$ echo -e "dtparam=i2c_arm=on\\ndtparam=spi=on" | sudo tee -a /boot/config.txt\n\n')])])]),a("p",[s._v("让 I2C 模块于系统启动时一并加载。")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('[fdsdr@centos ~]$ echo -e "i2c-dev" | sudo tee -a /etc/modules-load.d/modules.conf\n\n')])])]),a("p",[s._v("加载 I2C 模块。")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[fdsdr@centos ~]$ sudo dtparam i2c_arm=on\n[fdsdr@centos ~]$ sudo modprobe i2c-bcm2708\n\n")])])]),a("p",[s._v("重启以应用配置。")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[fdsdr@centos ~]$ sudo reboot\n\n")])])]),a("h2",{attrs:{id:"安装-docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装-docker"}},[s._v("#")]),s._v(" 安装 Docker")]),s._v(" "),a("p",[s._v("使用 Docker 相关安装脚本实现自动化安装。")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[fdsdr@centos ~]$ sudo curl -o /tmp/get-docker.sh -fsSL get.docker.com\n[fdsdr@centos ~]$ sudo chmod +x /tmp/get-docker.sh\n[fdsdr@centos ~]$ sudo sh -c /tmp/get-docker.sh\n\n")])])]),a("p",[s._v("中国大陆用户，在安装 Docker 时，可以加上 "),a("code",[s._v("--mirror AzureChinaCloud")]),s._v(" 参数，使用 AzureChinaCloud 镜像进行安装。")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[fdsdr@centos ~]$ sudo sh -c /tmp/get-docker.sh --mirror AzureChinaCloud\n\n")])])]),a("p",[s._v("安装完成后，将当前用户添加至 Docker 用户组 "),a("code",[s._v("docker")]),s._v("，然后重启。")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[fdsdr@centos ~]$ sudo usermod -aG docker ${USER}\n[fdsdr@centos ~]$ sudo systemctl enable docker\n[fdsdr@centos ~]$ sudo reboot\n\n")])])]),a("h2",{attrs:{id:"部署主程序"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#部署主程序"}},[s._v("#")]),s._v(" 部署主程序")]),s._v(" "),a("p",[s._v("创建一个 Docker 容器网桥（历史遗留问题）。")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[fdsdr@centos ~]$ docker network create -d bridge flydog-sdr\n\n")])])]),a("p",[s._v("拉取 FlyDog SDR 预编译镜像并部署。")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[fdsdr@centos ~]$ docker run -d \\\n             --name flydog-sdr \\\n             --network host \\\n             --privileged \\\n             --restart always \\\n             --volume kiwi.config:/root/kiwi.config \\\n             registry.cn-shanghai.aliyuncs.com/flydog-sdr/flydog-sdr:latest\n\n")])])]),a("h2",{attrs:{id:"部署升级模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#部署升级模块"}},[s._v("#")]),s._v(" 部署升级模块")]),s._v(" "),a("p",[s._v("FlyDog SDR Project 将升级模块与主程序分离以减小发行版大小，所以升级模块需要另行部署。")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[fdsdr@centos ~]$ docker run -d \\\n             --name admin \\\n             --network flydog-sdr \\\n             --publish 3708:3708 \\\n             --restart always \\\n             --volume /usr/bin/docker:/usr/bin/docker \\\n             --volume /var/run/docker.sock:/var/run/docker.sock \\\n             --volume kiwi.config:/etc/kiwi.config \\\n             registry.cn-shanghai.aliyuncs.com/flydog-sdr/admin:latest\n\n")])])])])}),[],!1,null,null,null);e.default=r.exports}}]);